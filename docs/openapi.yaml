openapi: 3.0.0
info:
  title: Shamsi Calendar API
  version: 1.0.0
  description: |
    A comprehensive RESTful API for the Afghan Shamsi (Solar Hijri) calendar with full support for Dari, Pashto, and English languages.
    
    ## Features
    - üìÖ Date conversion between Shamsi and Gregorian calendars
    - üóìÔ∏è Calendar views (day, week, month, year)
    - üéâ Holiday management and queries
    - üåç Multi-language support (Dari, Pashto, English)
    - üìä Calendar statistics and metadata
    
    ## Calendar System
    The Shamsi calendar (also known as Solar Hijri) is the official calendar of Afghanistan and Iran. It's a solar calendar with:
    - 12 months
    - First 6 months have 31 days
    - Next 5 months have 30 days  
    - Last month has 29 days (30 in leap years)
    - Week starts on Saturday
    
  contact:
    name: API Support
    email: support@example.com
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT

servers:
  - url: http://localhost:3000
    description: Development server
  - url: https://api.example.com
    description: Production server

tags:
  - name: Conversion
    description: Date conversion between Shamsi and Gregorian calendars
  - name: Calendar
    description: Calendar view generation (day, week, month, year)
  - name: Holidays
    description: Holiday information and queries
  - name: Info
    description: Utility endpoints for calendar metadata

paths:
  /:
    get:
      summary: Root endpoint
      description: Get API information and available endpoints
      responses:
        '200':
          description: API information
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiInfo'
                
  /health:
    get:
      summary: Health check
      description: Check if the API is running and healthy
      responses:
        '200':
          description: API is healthy
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Shamsi Calendar API is running
                  timestamp:
                    type: string
                    format: date-time

  /api/convert/shamsi-to-gregorian:
    post:
      tags: [Conversion]
      summary: Convert Shamsi to Gregorian
      description: Convert a date from Shamsi (Solar Hijri) calendar to Gregorian calendar
      parameters:
        - $ref: '#/components/parameters/Language'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ShamsiDate'
            examples:
              nowruz:
                summary: Nowruz 1403
                value:
                  year: 1403
                  month: 1
                  day: 1
              currentDate:
                summary: Current date example
                value:
                  year: 1403
                  month: 10
                  day: 19
      responses:
        '200':
          description: Successfully converted date
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConversionResponse'
        '400':
          $ref: '#/components/responses/BadRequest'

  /api/convert/gregorian-to-shamsi:
    post:
      tags: [Conversion]
      summary: Convert Gregorian to Shamsi
      description: Convert a date from Gregorian calendar to Shamsi (Solar Hijri) calendar
      parameters:
        - $ref: '#/components/parameters/Language'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GregorianDate'
            examples:
              newYear2025:
                summary: January 1, 2025
                value:
                  year: 2025
                  month: 1
                  day: 1
      responses:
        '200':
          description: Successfully converted date
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConversionResponse'
        '400':
          $ref: '#/components/responses/BadRequest'

  /api/convert/today:
    get:
      tags: [Conversion]
      summary: Get today's date
      description: Get today's date in both Shamsi and Gregorian calendars with detailed information
      parameters:
        - $ref: '#/components/parameters/Language'
        - $ref: '#/components/parameters/IncludeGregorian'
      responses:
        '200':
          description: Today's date information
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TodayResponse'

  /api/calendar/day/{year}/{month}/{day}:
    get:
      tags: [Calendar]
      summary: Get day view
      description: Get detailed information about a specific day including holidays and day of week
      parameters:
        - $ref: '#/components/parameters/Year'
        - $ref: '#/components/parameters/Month'
        - $ref: '#/components/parameters/Day'
        - $ref: '#/components/parameters/Language'
        - $ref: '#/components/parameters/IncludeHolidays'
        - $ref: '#/components/parameters/IncludeGregorian'
      responses:
        '200':
          description: Day information
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DayViewResponse'
        '400':
          $ref: '#/components/responses/BadRequest'

  /api/calendar/week/{year}/{month}/{day}:
    get:
      tags: [Calendar]
      summary: Get week view
      description: Get full week view containing the specified date
      parameters:
        - $ref: '#/components/parameters/Year'
        - $ref: '#/components/parameters/Month'
        - $ref: '#/components/parameters/Day'
        - $ref: '#/components/parameters/Language'
        - $ref: '#/components/parameters/StartOfWeek'
        - $ref: '#/components/parameters/IncludeHolidays'
        - $ref: '#/components/parameters/IncludeGregorian'
      responses:
        '200':
          description: Week information
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WeekViewResponse'
        '400':
          $ref: '#/components/responses/BadRequest'

  /api/calendar/month/{year}/{month}:
    get:
      tags: [Calendar]
      summary: Get month view
      description: Get complete month calendar with all weeks, days, and statistics
      parameters:
        - $ref: '#/components/parameters/Year'
        - $ref: '#/components/parameters/Month'
        - $ref: '#/components/parameters/Language'
        - $ref: '#/components/parameters/StartOfWeek'
        - $ref: '#/components/parameters/IncludeHolidays'
        - $ref: '#/components/parameters/IncludeGregorian'
      responses:
        '200':
          description: Month calendar information
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MonthViewResponse'
        '400':
          $ref: '#/components/responses/BadRequest'

  /api/calendar/year/{year}:
    get:
      tags: [Calendar]
      summary: Get year view
      description: Get complete year overview with all 12 months and statistics
      parameters:
        - $ref: '#/components/parameters/Year'
        - $ref: '#/components/parameters/Language'
        - $ref: '#/components/parameters/Format'
        - $ref: '#/components/parameters/IncludeHolidays'
        - $ref: '#/components/parameters/IncludeGregorian'
      responses:
        '200':
          description: Year overview information
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/YearViewResponse'
        '400':
          $ref: '#/components/responses/BadRequest'

  /api/holidays:
    get:
      tags: [Holidays]
      summary: Get all holidays
      description: Get all holidays across all years with optional pagination
      parameters:
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
          description: Number of holidays to return
        - name: skip
          in: query
          schema:
            type: integer
            minimum: 0
          description: Number of holidays to skip
      responses:
        '200':
          description: List of holidays
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HolidayListResponse'

  /api/holidays/year/{year}:
    get:
      tags: [Holidays]
      summary: Get holidays by year
      description: Get all holidays for a specific Shamsi year
      parameters:
        - $ref: '#/components/parameters/Year'
      responses:
        '200':
          description: Holidays for the specified year
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HolidayListResponse'
        '400':
          $ref: '#/components/responses/BadRequest'

  /api/holidays/year/{year}/month/{month}:
    get:
      tags: [Holidays]
      summary: Get holidays by year and month
      description: Get all holidays for a specific month in a Shamsi year
      parameters:
        - $ref: '#/components/parameters/Year'
        - $ref: '#/components/parameters/Month'
      responses:
        '200':
          description: Holidays for the specified month
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HolidayListResponse'
        '400':
          $ref: '#/components/responses/BadRequest'

  /api/holidays/{id}:
    get:
      tags: [Holidays]
      summary: Get holiday by ID
      description: Get a specific holiday by its unique identifier
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
          description: Holiday ID (format: year-month-day)
          example: "1403-1-1"
      responses:
        '200':
          description: Holiday information
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/Holiday'
        '404':
          $ref: '#/components/responses/NotFound'

  /api/holidays/search:
    get:
      tags: [Holidays]
      summary: Search holidays
      description: Search holidays by name in the specified language
      parameters:
        - name: q
          in: query
          required: true
          schema:
            type: string
          description: Search term
          example: nowruz
        - $ref: '#/components/parameters/Language'
      responses:
        '200':
          description: Search results
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HolidayListResponse'
        '400':
          $ref: '#/components/responses/BadRequest'

  /api/holidays/statistics:
    get:
      tags: [Holidays]
      summary: Get holiday statistics
      description: Get statistics about holidays (total count, by type, etc.)
      parameters:
        - name: year
          in: query
          schema:
            type: integer
          description: Filter by specific year (optional)
      responses:
        '200':
          description: Holiday statistics
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HolidayStatisticsResponse'

  /api/info:
    get:
      tags: [Info]
      summary: Get API information
      description: Get detailed API information including features and endpoints
      responses:
        '200':
          description: API information
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiInfo'

  /api/info/months:
    get:
      tags: [Info]
      summary: Get all month names
      description: Get all 12 Shamsi month names in all three languages (Dari, Pashto, English)
      responses:
        '200':
          description: Month names
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MonthNamesResponse'

  /api/info/days:
    get:
      tags: [Info]
      summary: Get all day names
      description: Get all 7 day names in all three languages (Dari, Pashto, English)
      responses:
        '200':
          description: Day names
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DayNamesResponse'

  /api/info/leap-years/{startYear}/{endYear}:
    get:
      tags: [Info]
      summary: Get leap years in range
      description: Get all Shamsi leap years in the specified range
      parameters:
        - name: startYear
          in: path
          required: true
          schema:
            type: integer
            minimum: 1
          description: Start year
          example: 1400
        - name: endYear
          in: path
          required: true
          schema:
            type: integer
            minimum: 1
          description: End year (must be greater than start year)
          example: 1410
      responses:
        '200':
          description: List of leap years
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LeapYearsResponse'
        '400':
          $ref: '#/components/responses/BadRequest'

components:
  parameters:
    Language:
      name: lang
      in: query
      schema:
        type: string
        enum: [dari, pashto, english]
        default: english
      description: Response language
      
    IncludeGregorian:
      name: includeGregorian
      in: query
      schema:
        type: boolean
        default: true
      description: Include Gregorian dates in response
      
    IncludeHolidays:
      name: includeHolidays
      in: query
      schema:
        type: boolean
        default: true
      description: Include holiday information
      
    StartOfWeek:
      name: startOfWeek
      in: query
      schema:
        type: integer
        enum: [1, 2, 3]
        default: 1
      description: First day of week (1=Saturday, 2=Sunday, 3=Monday)
      
    Format:
      name: format
      in: query
      schema:
        type: string
        enum: [full, compact]
        default: full
      description: Response detail level
      
    Year:
      name: year
      in: path
      required: true
      schema:
        type: integer
        minimum: 1
        maximum: 3000
      description: Shamsi year
      
    Month:
      name: month
      in: path
      required: true
      schema:
        type: integer
        minimum: 1
        maximum: 12
      description: Shamsi month (1-12)
      
    Day:
      name: day
      in: path
      required: true
      schema:
        type: integer
        minimum: 1
        maximum: 31
      description: Shamsi day (1-31)

  schemas:
    ShamsiDate:
      type: object
      required: [year, month, day]
      properties:
        year:
          type: integer
          minimum: 1
          maximum: 3000
          example: 1403
        month:
          type: integer
          minimum: 1
          maximum: 12
          example: 10
        day:
          type: integer
          minimum: 1
          maximum: 31
          example: 19
          
    GregorianDate:
      type: object
      required: [year, month, day]
      properties:
        year:
          type: integer
          minimum: 1
          maximum: 3000
          example: 2025
        month:
          type: integer
          minimum: 1
          maximum: 12
          example: 1
        day:
          type: integer
          minimum: 1
          maximum: 31
          example: 8
          
    LocalizedName:
      type: object
      properties:
        dari:
          type: string
          example: "ŸÜŸàÿ±Ÿàÿ≤"
        pashto:
          type: string
          example: "ŸÜŸà€å ⁄©ÿßŸÑ"
        english:
          type: string
          example: "Nowruz"
          
    Holiday:
      type: object
      properties:
        id:
          type: string
          example: "1403-1-1"
        shamsiYear:
          type: integer
          example: 1403
        shamsiMonth:
          type: integer
          example: 1
        shamsiDay:
          type: integer
          example: 1
        names:
          $ref: '#/components/schemas/LocalizedName'
        descriptions:
          $ref: '#/components/schemas/LocalizedName'
        type:
          type: string
          enum: [national, religious, cultural, international]
          example: national
        isNationalHoliday:
          type: boolean
          example: true
        isPublicHoliday:
          type: boolean
          example: true
          
    ConversionResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        data:
          type: object
          properties:
            input:
              type: object
              properties:
                calendar:
                  type: string
                  example: Shamsi
                date:
                  oneOf:
                    - $ref: '#/components/schemas/ShamsiDate'
                    - $ref: '#/components/schemas/GregorianDate'
            output:
              type: object
              properties:
                calendar:
                  type: string
                  example: Gregorian
                date:
                  oneOf:
                    - $ref: '#/components/schemas/ShamsiDate'
                    - $ref: '#/components/schemas/GregorianDate'
                    
    TodayResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        data:
          type: object
          properties:
            shamsi:
              $ref: '#/components/schemas/ShamsiDate'
            gregorian:
              $ref: '#/components/schemas/GregorianDate'
            dayOfWeek:
              type: object
              properties:
                number:
                  type: integer
                  example: 4
                name:
                  type: string
                  example: Tuesday
            month:
              type: object
              properties:
                number:
                  type: integer
                  example: 10
                name:
                  type: string
                  example: Jadi
            isWeekend:
              type: boolean
              example: false
            formattedShamsi:
              type: string
              example: "Jadi 19, 1403"
              
    DayViewResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        data:
          type: object
          description: Day information with optional holidays
          
    WeekViewResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        data:
          type: object
          description: Week information with 7 days
          
    MonthViewResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        data:
          type: object
          description: Month calendar with weeks and statistics
          
    YearViewResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        data:
          type: object
          description: Year overview with 12 months and statistics
          
    HolidayListResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        count:
          type: integer
          example: 4
        data:
          type: array
          items:
            $ref: '#/components/schemas/Holiday'
            
    HolidayStatisticsResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        data:
          type: object
          properties:
            total:
              type: integer
              example: 15
            byType:
              type: object
              additionalProperties:
                type: integer
              example:
                national: 8
                religious: 5
                cultural: 2
            national:
              type: integer
              example: 8
            public:
              type: integer
              example: 12
              
    MonthNamesResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        data:
          type: array
          items:
            type: object
            properties:
              number:
                type: integer
                example: 1
              names:
                $ref: '#/components/schemas/LocalizedName'
                
    DayNamesResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        data:
          type: array
          items:
            type: object
            properties:
              number:
                type: integer
                example: 1
              names:
                $ref: '#/components/schemas/LocalizedName'
                
    LeapYearsResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        count:
          type: integer
          example: 3
        data:
          type: array
          items:
            type: integer
          example: [1401, 1405, 1409]
          
    ApiInfo:
      type: object
      properties:
        success:
          type: boolean
          example: true
        message:
          type: string
          example: Welcome to Shamsi Calendar API
        version:
          type: string
          example: "1.0.0"
        documentation:
          type: string
          example: /api-docs
        endpoints:
          type: object
          properties:
            conversion:
              type: string
              example: /api/convert
            calendar:
              type: string
              example: /api/calendar
            holidays:
              type: string
              example: /api/holidays
            info:
              type: string
              example: /api/info
              
    ErrorResponse:
      type: object
      properties:
        success:
          type: boolean
          example: false
        error:
          type: object
          properties:
            message:
              type: string
              example: Invalid Shamsi date
            statusCode:
              type: integer
              example: 400

  responses:
    BadRequest:
      description: Invalid request or validation error
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            success: false
            error:
              message: Invalid Shamsi date
              statusCode: 400
              
    NotFound:
      description: Resource not found
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            success: false
            error:
              message: Holiday not found
              statusCode: 404
              
    TooManyRequests:
      description: Rate limit exceeded
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            success: false
            error:
              message: Too many requests, please try again later
              statusCode: 429